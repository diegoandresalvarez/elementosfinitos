xnod = [ ... % posicion de los nodos
       1    0.0000      1.0000     
       2    0.0000      2.0000     
       3    0.0000      1.0833     
       4    0.0000      1.1667     
       5    0.0000      1.2500     
       6    0.0000      3.0000     
       7    0.0000      2.1667     
       8    0.0000      2.3333     
       9    0.0000      2.4167     
      10    3.0000      0.0000     
      11    2.9990     0.78459E-01 
      12    2.9959     0.15686     
      13    2.9908     0.23538     
      14    2.9836     0.31373     
      15    2.9743     0.39165     
      16    2.9631     0.46930     
      17    2.9498     0.54671     
      18    2.9344     0.62374     
      19    2.8978     0.77646     
      20    2.8532     0.92705     
      21    2.7716      1.1481     
      22    2.6730      1.3620     
      23    2.5981      1.5        % cargaa
      24    2.4271      1.7634     
      25    2.2812      1.9483     
      26    2.1213      2.1213     
      27    1.9483      2.2812     
      28    1.7634      2.4271     
      29    1.50        2.5981     % carga
      30    2.0000      0.0000     
      31    2.1667      0.0000     
      32    2.3333      0.0000     
      33    2.4167      0.0000     
      34    1.0000      0.0000     
      35    1.0833      0.0000     
      36    1.1667      0.0000     
      37    1.2500      0.0000     
      38   0.99786     0.65403E-01 
      39   0.99144     0.13053     
      40   0.98079     0.19509     
      41   0.96593     0.25882     
      42   0.94693     0.32144     
      43   0.92388     0.38268     
      44   0.89687     0.44229     
      45    1.7654      1.1852     
      46    1.9184     0.78185     
      47    2.2457     0.74767     
      48    2.2981      1.2338     
      49    2.5000      0.0000     
      50   0.85685      1.3184     
      51    1.4061     0.60012     
      52    1.0039      2.3272     
      53    1.8112     0.50329     
      54    2.3294     0.45531     
      55    2.5285     0.92038     
      56    2.0030      1.5049     
      57    1.6751      1.7364     
      58    1.1690      1.9459     
      59    1.3620      2.6730     
      60   0.50745      2.5482     
      61   0.70980      2.1677     
      62    1.0874     0.92998     
      63    2.0683      1.0378     
      64   0.59109      1.1127     
      65   0.31236      2.0772     
      66    1.1579     0.51097     
      67    1.4336     0.23048     
      68    2.3855     0.73943     
      69    2.4249     0.23694     
      70    2.6397     0.47953     
      71    2.6908     0.92372     
      72    2.4856      1.2979     
      73    2.2150      1.6341     
      74    1.8982      1.9289     
      75    1.4662      2.1865     
      76    1.1830      2.5001     
      77    0.0000      2.5000     
      78   0.44902      2.6917     
      79   0.28404      2.4844     
      80    1.9196     0.24166     
      81   0.43448      1.4810     
      82    1.9168      1.1115     
      83    1.8842      1.3451     
      84    1.7111      1.0312     
      85    1.3333      0.0000     
      86    1.8648     0.64257     
      87    2.4167     0.87561     
      88    1.1481      2.7716     
      89    1.9933     0.90984     
      90    2.5833      0.0000     
      91    2.1866     0.93434     
      92    2.4133      1.0771     
      93    2.1506      1.3694     
      94    2.1832      1.1358     
      95    1.3620      1.0632     
      96    0.0000      1.3333     
      97   0.92705      2.8532     
      98   0.88822     0.78670     
      99    1.6929     0.52010     
     100   0.89876      2.4411     
     101   0.85687      2.2475     
     102    1.0865      2.1366     
     103    2.6667      0.0000     
     104    1.9536     0.48937     
     105   0.77646      2.8978     
     106    1.8391      1.6207     
     107    1.4221      1.8412     
     108    1.5077      1.5047     
     109    2.3050     0.83083     
     110   0.66601      2.2690     
     111   0.62374      2.9344     
     112   0.54671      2.9498     
     113    0.0000      2.5833     
     114    0.0000      2.6667     
     115   0.86603     0.50000     
     116   0.79335     0.60876     
     117   0.70711     0.70711     
     118   0.60876     0.79335     
     119    1.4167      0.0000     
     120    1.5000      0.0000     
     121    0.0000      1.4167     
     122    0.0000      1.5000     
     123   0.50000     0.86603     
     124   0.44229     0.89687     
     125   0.34956      1.1275     
     126   0.17852      1.1612     
     127   0.23807      1.3269     
     128   0.47687      1.2795     
     129    1.1474     0.13851     
     130    1.1159     0.29118     
     131    1.2569     0.29833     
     132    1.3038     0.14576     
     133    1.0013     0.62697     
     134    1.1572     0.78535     
     135    1.2356     0.55147     
     136    1.0802     0.47047     
     137   0.56047     0.95975     
     138   0.77514     0.94642     
     139   0.50388      1.0583     
     140   0.67830      1.1671     
     141   0.16370      2.8146     
     142   0.31594      2.8145     
     143   0.32236      2.6282     
     144   0.18741      2.6432     
     145    2.7742     0.31489     
     146    2.7977     0.16114     
     147    2.6216     0.16312     
     148    2.5805     0.32085     
     149   0.60473      2.6716     
     150   0.79358      2.5549     
     151   0.42925      2.6444     
     152   0.46880      2.7389     
     153    2.6512     0.67407     
     154    2.4661     0.64804     
     155    2.7394     0.48249     
     156    2.5401     0.47657     
     157   0.32837      2.1983     
     158   0.42824      2.3562     
     159   0.21680      2.4791     
     160   0.35128      2.4897     
     161   0.62222      2.3702     
     162   0.27784      1.6955     
     163   0.29635      1.9561     
     164   0.72547      1.9325     
     165   0.68683      1.6879     
     166   0.57539      1.4582     
     167   0.29357      1.5039     
     168    1.6513     0.22554     
     169    1.5264     0.33536     
     170    1.4710     0.15588     
     171    1.3962     0.30507     
     172    2.3528     0.12455     
     173    2.1879     0.25778     
     174    2.3775     0.31312     
     175    2.4724     0.16076     
     176    2.1864     0.66452     
     177    2.3371     0.58506     
     178    2.0960     0.47545     
     179    1.6567     0.87726     
     180    1.5745     0.53691     
     181    1.3838     0.85355     
     182    1.3403      1.2729     
     183    1.0176      1.0746     
     184    1.0383      1.5577     
     185   0.86256      1.6228     
     186   0.70790      2.4626     
     187   0.11903      1.3301     
     188   0.89259E-01  1.1639     
     189   0.15415      1.0764     
     190   0.20829      1.2440     
     191   0.26404      1.1444     
     192   0.26582      1.4154     
     193   0.35747      1.3032     
     194   0.52613      1.3688     
     195   0.41322      1.2035     
     196   0.57759      1.2233     
     197   0.30456      1.0466     
     198   0.42672      1.0929     
     199    1.2463     0.42490     
     200    1.0981     0.38082     
     201    1.0409     0.27500     
     202    1.1864     0.29476     
     203    1.1316     0.21484     
     204    1.3266     0.30170     
     205    1.2804     0.22205     
     206    1.3874     0.15082     
     207    1.2256     0.14213     
     208    1.3186     0.72880E-01 
     209    1.0694     0.13452     
     210    1.1570     0.69253E-01 
     211    1.3208     0.57580     
     212    1.2705     0.81945     
     213    1.0792     0.70616     
     214    1.1964     0.66841     
     215    1.0408     0.54872     
     216    1.0020     0.42658     
     217   0.93366     0.56349     
     218   0.44328     0.99107     
     219   0.53023     0.91289     
     220   0.53217      1.0090     
     221   0.66780     0.95309     
     222   0.72672      1.0568     
     223   0.76757      1.2428     
     224   0.74112     0.82676     
     225   0.89635      1.0105     
     226   0.37581      2.6363     
     227   0.39237      2.7767     
     228   0.31476      2.8990     
     229   0.31915      2.7213     
     230   0.23982      2.8145     
     231   0.33682      2.5589     
     232   0.25489      2.6357     
     233   0.20210      2.5611     
     234   0.17555      2.7289     
     235   0.93703E-01  2.6549     
     236   0.16036      2.9052     
     237   0.81851E-01  2.8240     
     238    2.6441     0.81560E-01 
     239    2.8155     0.80569E-01 
     240    2.8968     0.15900     
     241    2.7097     0.16213     
     242    2.7860     0.23801     
     243    2.5470     0.16194     
     244    2.6010     0.24198     
     245    2.4790     0.31698     
     246    2.6774     0.31787     
     247    2.5603     0.39871     
     248    2.8789     0.31431     
     249    2.7568     0.39869     
     250   0.46835      2.5963     
     251   0.55609      2.6099     
     252   0.53676      2.7052     
     253   0.46905      2.8510     
     254   0.69916      2.6133     
     255   0.61423      2.8030     
     256   0.86032      2.7040     
     257    2.8512     0.47590     
     258    2.7928     0.64890     
     259    2.5898     0.79723     
     260    2.6953     0.57828     
     261    2.5586     0.66105     
     262    2.5031     0.56231     
     263    2.4347     0.46594     
     264    2.4016     0.61655     
     265   0.10840      2.4896     
     266   0.16419      2.2658     
     267   0.51909      2.1830     
     268   0.27259      2.3387     
     269   0.37830      2.2773     
     270   0.38976      2.4229     
     271   0.42937      2.5189     
     272   0.56484      2.4592     
     273   0.52523      2.3632     
     274   0.71612      1.3883     
     275   0.71764      2.0501     
     276   0.70615      1.8102     
     277   0.51091      1.9443     
     278   0.48234      1.6917     
     279   0.63111      1.5730     
     280   0.28570      1.5997     
     281   0.14678      1.5019     
     282   0.28709      1.8258     
     283   0.13892      1.6811     
     284   0.14817      1.9781     
     285    1.4855     0.77939E-01 
     286    1.6590     0.11277     
     287    1.7313     0.36441     
     288    1.5612     0.19071     
     289    1.5889     0.28045     
     290    1.4613     0.32022     
     291    1.4012     0.45260     
     292    1.5505     0.43614     
     293    2.3534     0.38422     
     294    2.1420     0.36661     
     295    2.0940     0.12889     
     296    2.2703     0.19117     
     297    2.2827     0.28545     
     298    2.4126     0.14266     
     299    2.4862     0.80382E-01 
     300    2.3430     0.62277E-01 
     301    2.0524     0.72318     
     302    2.2127     0.46538     
     303    2.1412     0.56998     
     304    2.2617     0.62479     
     305    2.3332     0.52019     
     306    1.7875     0.82955     
     307    1.3950     0.72684     
     308    1.5202     0.86541     
     309    1.6156     0.70709     
     310    1.4903     0.56852     
     311    1.5528      1.2290     
     312   0.93721      1.1965     
     313    1.1893      1.4153     
     314    1.1789      1.1737     
     315   0.94726      1.9392     
     316    1.1037      1.7518     
     317   0.94756      1.4381     
     318    2.7500      0.0000     
     319    1.5833      0.0000     
     320    0.0000      1.5833     
     321    0.0000      2.7500     
     322   0.46930      2.9631     
     323   0.39158      2.9743     
     324   0.31359      2.9836     
     325   0.23538      2.9908     
     326    2.8333      0.0000     
     327    2.9167      0.0000     
     328   0.15701      2.9959     
     329    0.0000      2.8333     
     330    0.0000      2.9167     
     331   0.78531E-01  2.9990     
     332   0.38268     0.92388     
     333   0.32180     0.94681     
     334   0.25955     0.96573     
     335    1.6667      0.0000     
     336    1.8333      0.0000     
     337   0.19509     0.98079     
     338   0.12978     0.99154     
     339   0.65025E-01 0.99788     
     340    0.0000      1.6667     
     341    0.0000      1.8333];

xnod = xnod(:,[2 3]);

LaG = [ ... % definicion de elementos finitos con respecto a nodos
   1   149    60   161   150   251   272   186   254
   2    63    46   176   109    89   301    47    91
   3   125   334   332   139   197   333   218   198
   4   129    39    34    36   209    38    35   210
   5   138   117   115   133   224   116   217    98
   6   163   164    61   157   277   275   267    65
   7   141   328     6   329   236   331   330   237
   8   145    14    16   155   248    15   257   249
   9   149   150    97   111   254   256   105   255
  10   183   138   133   134   225    98   213    62
  11    48    55    20    22    92    71    21    72
  12    56    48    22    24    93    72    23    73
  13    57    56    24    26   106    73    25    74
  14    58    57    26    28   107    74    27    75
  15   150    52    59    97   100    76    88   256
  16    58    28    59    52    75    29    76   102
  17   161   158   157    61   273   269   267   110
  18   162   163     2   340   282   284   341   283
  19   180   169   168    53   292   289   287    99
  20    32   172   173    30   300   296   295    31
  21   178    54   177   176   302   305   304   303
  22   181    51   180   179   307   310   309   308
  23    48    63   109    55    94    91    87    92
  24    45    63    48    56    82    94    93    83
  25    57   182    45    56   108   311    83   106
  26    46    63    45   179    89    82    84   306
  27   181   179    45   182   308    84   311    95
  28    50   183   182   184   312   314   313   317
  29   164   165   184    58   276   185   316   315
  30   181   182   183   134    95   314    62   212
  31   182    57    58   184   108   107   316   313
  32    58    52    61   164   102   101   275   315
  33   177   154   109   176   264    68    47   304
  34   154   153    55   109   261   259    87    68
  35    53   168   173   178   287    80   294   104
  36   168   335    30   173   286   336   295    80
  37     2   163   157     8   284    65   266     7
  38    52   150   161    61   100   186   110   101
  39   151    60   149   152   250   251   252    78
  40   137   123   117   138   219   118   224   221
  41   153    18    20    55   258    19    71   259
  42   165   166    50   184   279   274   317   185
  43   122    96   127   167   121   187   192   281
  44    96     4   126   127     5   188   190   187
  45     4     1   338   126     3   339   189   188
  46   126   338   334   125   189   337   197   191
  47   127   126   125   128   190   191   195   193
  48   167   127   128   166   192   193   194    81
  49   166   128   140    50   194   196   223   274
  50   128   125   139   140   195   198    64   196
  51    51   135   131   171   211   199   204   291
  52   135   136   130   131    66   200   202   199
  53   136    43    41   130   216    42   201   200
  54   130    41    39   129   201    40   209   203
  55   131   130   129   132   202   203   207   205
  56   171   131   132   170   204   205   206    67
  57   170   132    85   120   206   208   119   285
  58   132   129    36    85   207   210    37   208
  59    51   181   134   135   307   212   214   211
  60   134   133   136   135   213   215    66   214
  61   136   133   115    43   215   217    44   216
  62   332   123   137   139   124   219   220   218
  63   139   137   138   140   220   221   222    64
  64   140   138   183    50   222   225   312   223
  65    60   151   143   160   250   226   231   271
  66   151   152   142   143    78   227   229   226
  67   152   322   324   142   253   323   228   227
  68   142   324   328   141   228   325   236   230
  69   143   142   141   144   229   230   234   232
  70   160   143   144   159   231   232   233    79
  71   159   144   114    77   233   235   113   265
  72   144   141   329   114   234   237   321   235
  73    49   103   147   175    90   238   243   299
  74   103   326   146   147   318   239   241   238
  75   326    10    12   146   327    11   240   239
  76   146    12    14   145   240    13   248   242
  77   147   146   145   148   241   242   246   244
  78   175   147   148   174   243   244   245    69
  79   174   148   156    54   245   247   263   293
  80   148   145   155   156   246   249    70   247
  81   152   149   111   322   252   255   112   253
  82    16    18   153   155    17   258   260   257
  83   155   153   154   156   260   261   262    70
  84   156   154   177    54   262   264   305   263
  85    77     8   157   159     9   266   268   265
  86   159   157   158   160   268   269   270    79
  87   160   158   161    60   270   273   272   271
  88   165   164   163   162   276   277   282   278
  89   165   162   167   166   278   280    81   279
  90   167   162   340   122   280   283   320   281
  91   120   335   168   170   319   286   288   285
  92   170   168   169   171   288   289   290    67
  93   171   169   180    51   290   292   310   291
  94    54   178   173   174   302   294   297   293
  95   173   172   175   174   296   298    69   297
  96   175   172    32    49   298   300    33   299
  97    53   178   176    46   104   303   301    86
  98   179   180    53    46   309    99    86   306
];
LaG = LaG(:,[2:9]);
LaG = LaG(:,[1 5 2 6 3 7 4 8]);

%% Se definen las restricciones
% X = 1; Y = 2;
nodos_restringidos = [1 3 339 34 35 38 10 11 327 6 330 331]';
nnr = length(nodos_restringidos);
restricciones = [ nodos_restringidos repmat(X,nnr,1) zeros(nnr,1)
                  nodos_restringidos repmat(Y,nnr,1) zeros(nnr,1) ];
