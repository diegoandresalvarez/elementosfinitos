clear, clc, close all

xnod = 1000*[...
0	0	0
7.315	0	0
14.63	0	0
14.63	7.315	0
7.315	7.315	0
0	7.315	0
0	0	3.658
7.315	0	3.658
14.63	0	3.658
14.63	7.315	3.658
7.315	7.315	3.658
0	7.315	3.658
0	0	7.316
7.315	0	7.316
14.63	0	7.316
14.63	7.315	7.316
7.315	7.315	7.316
0	7.315	7.316
0	0	10.974
7.315	0	10.974
14.63	0	10.974
14.63	7.315	10.974
7.315	7.315	10.974
0	7.315	10.974
0	0	14.632
7.315	0	14.632
7.315	7.315	14.632
0	7.315	14.632
0	0	18.29
7.315	0	18.29
7.315	7.315	18.29
0	7.315	18.29
0	0	21.948
7.315	0	21.948
7.315	7.315	21.948
0	7.315	21.948   ];

barra = [ ...
1	7	1
2	8	2
3	9	1
4	10	1
5	11	2
6	12	1
7	8	5
8	9	5
9	10	4
11	10	5
8	11	1
12	11	5
7	12	4
7	13	1
8	14	2
9	15	1
10	16	1
11	17	2
12	18	1
13	14	5
14	15	5
15	16	4
17	16	5
14	17	1
18	17	5
13	18	4
13	19	1
14	20	2
15	21	1
16	22	1
17	23	2
18	24	1
19	20	5
20	21	5
21	22	4
23	22	5
20	23	1
24	23	5
19	24	4
19	25	3
20	26	3
23	27	3
24	28	3
25	26	5
26	27	4
28	27	5
25	28	4
25	29	3
26	30	3
27	31	3
28	32	3
29	30	5
30	31	4
32	31	5
29	32	4
29	33	3
30	34	3
31	35	3
32	36	3
33	34	5
34	35	4
36	35	5
33	36	4 ];
LaG = barra(:,[1 2]);
tipo_barra = barra(:,3);


% A(mm²)	Iz (mm⁴)	Iy (mm⁴)	J (mm⁴)
propiedades = [ ...
16516.096	308011254.944  100311773.570	2122780.271
22774.148	445367625.392	 1435998.418    5369385.390
11354.816	141934916.130	48282845.370	1032253.935
10064.496	176898355.880	39874970.572     657645.652
 4935.474	 84911210.822	 7200803.663     124869.428
];

X = 1; Y = 2; Z = 3; 

nno  = size(xnod,1); % numero de nodos (numero de filas de xnod)
nbar = size(LaG,1);  % numero de EFs (numero de filas de LaG)

parX = [];
parY = [];
parZ = [];
for e = 1:nbar
    if xnod(LaG(e,1),Z) ==  xnod(LaG(e,2),Z) && xnod(LaG(e,1),Y) ==  xnod(LaG(e,2),Y)
        parX = [parX e];
        continue
    end

    if xnod(LaG(e,1),X) ==  xnod(LaG(e,2),X) && xnod(LaG(e,1),Z) ==  xnod(LaG(e,2),Z)
        parY = [parY e];
        continue
    end

    if xnod(LaG(e,1),X) ==  xnod(LaG(e,2),X) && xnod(LaG(e,1),Y) ==  xnod(LaG(e,2),Y)
        parZ = [parZ e];
    end
end

V3 = zeros(nbar,3);
V3_V1 = zeros(nbar,3);
for e = 1:nbar
    switch e
        case num2cell(parX)
            V3_V1(e,:) = [0 0 1];
        case num2cell(parY)
            V3_V1(e,:) = [0 0 1];
        case num2cell(parZ)
            V3_V1(e,:) = [0 1 0];
    end
    V1 = xnod(LaG(e,1),:);
    V3(e,:) = V1 + V3_V1(e,:);
end

save portico_3d xnod LaG tipo_barra propiedades V3_V1
